{% extends 'medecin/baseMedecin.html.twig' %}

{% block title %}Liste des rendez-vous Envoyer{% endblock %}

{% block body %}
    <div class="container mt-5">
        <h1 class="mb-4">Liste des rendez-vous Envoyer</h1>

        {# Tableau des rendez-vous #}
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Date</th>
                        <th scope="col">Heure</th>
                        <th scope="col">Médecin</th>
                        <th scope="col">Service</th>
                        <th scope="col">Statut</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for rendezVous in rendezVousList %}
                        <tr>
                            <td>{{ rendezVous.id }}</td>
                            <td>{{ rendezVous.date ? rendezVous.date|date('d/m/Y') : '' }}</td>
                            <td>{{ rendezVous.heure ? rendezVous.heure|date('H:i') : '' }}</td>
                            <td>{{ rendezVous.medecin ? rendezVous.medecin.nom : 'Non défini' }}</td>
                            <td>{{ rendezVous.service ? rendezVous.service.nom.value : 'Non défini' }}</td>
                           
                            <td>
                              {% if rendezVous.rendezVousStatus == 'EnAttente' %}
                                  {# Afficher les boutons seulement si le statut est "EnAttente" #}
                                  <form action="{{ path('accepter_rendezvous', {'id': rendezVous.id}) }}" method="POST" class="d-inline">
                                      <button type="submit" class="btn btn-sm btn-success">
                                          <i class="fas fa-check"></i> Accepter
                                      </button>
                                  </form>
                                  <form action="{{ path('refuser_rendezvous', {'id': rendezVous.id}) }}" method="POST" class="d-inline">
                                      <button type="submit" class="btn btn-sm btn-danger">
                              <i class="fas fa-times"></i> Refuser
                          </button>
                      </form>
                  {% elseif rendezVous.rendezVousStatus == 'Confirme' %}
                      {# Afficher le statut si confirmé #}
                      <span class="badge bg-success">Confirmé</span>
                  {% elseif rendezVous.rendezVousStatus == 'Annule' %}
                      {# Afficher le statut si refusé #}
                      <span class="badge bg-danger">Refusé</span>
                  {% else %}
                      {# Afficher le statut si un autre état est présent #}
                      <span class="badge bg-secondary">{{ rendezVous.rendezVousStatus }}</span>
                  {% endif %}
              </td>

                            <td>
                                <a href="{{ path('modifier_rendezvous', {'id': rendezVous.id}) }}" class="btn btn-sm btn-primary">
                                    <i class="fas fa-edit"></i> Modifier
                                </a>
                                <form action="{{ path('supprimer_rendezvous', {'id': rendezVous.id}) }}" method="POST" class="d-inline" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer ce rendez-vous ?');">
                                    <input type="hidden" name="_method" value="POST">
                                    <button type="submit" class="btn btn-sm btn-danger">
                                        <i class="fas fa-trash"></i> Supprimer
                                    </button>
                                </form>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="7" class="text-center">Aucun rendez-vous trouvé.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
